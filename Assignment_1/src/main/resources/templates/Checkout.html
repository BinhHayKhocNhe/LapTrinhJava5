<!doctype html>
<html lang="en">

<head>
<title>Title</title>
<!-- Required meta tags -->
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />

<!-- Bootstrap CSS v5.2.1 -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
	crossorigin="anonymous" />
<link rel="stylesheet" href="/css/header.css">
<link rel="stylesheet" href="/css/footer.css">
<link rel="icon"
	href="https://phuongnamvina.com/img_data/images/lam-logo-ban-hang-online-dep.jpg">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
	crossorigin="anonymous">
<script defer="" type="text/javascript"
	src="https://web.nvnstatic.net/js/bootstrap/bootstrap-3.3.5.min.js?v=2"></script>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap"
	rel="stylesheet">
<link rel="stylesheet" href="/css/base.css">

</head>
<style>
.product-quantity {
	position: absolute;
	top: -10px;
	right: -10px;
	background-color: #3982e0;
	/* Màu xanh */
	color: #fff;
	/* Màu trắng */
	border-radius: 50%;
	width: 20px;
	height: 20px;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 12px;
}

.product-image-box {
	display: inline-block;
	padding: 5px;
	background-color: #fff;
	border: 1px solid #f3dada;
	/* Đổi màu viền nếu cần */
}

.product-image {
	max-width: 50px;
}
</style>

<body>
	<div th:insert="fragments/header :: header"></div>
	<main>
		<div class="container my-5">
			<div class="row">
				<!-- Cột 1: Thông tin mua hàng -->
				<div class="col-12 col-md-4">
					<h3 class="mb-3">Thông tin mua hàng</h3>
					<form>
						<div class="mb-3">
							<label for="email" class="form-label">Email</label> <input
								type="email" class="form-control" id="email" name="email"
								placeholder="Nhập email">
						</div>
						<div class="mb-3">
							<label for="name" class="form-label">Họ và tên</label> <input
								type="text" class="form-control" id="name" name="name"
								placeholder="Nhập họ và tên">
						</div>
						<div class="mb-3">
							<label for="phone" class="form-label">Số điện thoại</label> <input
								type="tel" class="form-control" id="phone" name="phone"
								placeholder="Nhập số điện thoại">
						</div>
						<!-- <div class="mb-3 ">
							<label for="province" class="form-label">Tỉnh/Thành phố</label> <select
								class="form-control" name="province" id="province" required>
								<option disabled selected>Chọn tỉnh/thành</option>
							</select>
						</div>

						<div class="mb-3">
							<label for="district" class="form-label">Quận/Huyện</label> <select
								class="form-control" name="district" id="district" required>
								<option disabled selected>Chọn quận/huyện</option>
							</select> </select>
						</div>
						<div class="mb-3">
							<label for="ward" class="form-label">Phường/Xã</label> <select
								class="form-control" name="ward" id="ward" required>
								<option disabled selected>Chọn xã/phường</option>
							</select>
						</div>
						<div class="mb-3">
							<label for="address" class="form-label">Đường/Hẻm/Số nhà:</label>
							<input type="text" class="form-control" id="address"
								name="address" required>
						</div> -->



						<div class="form-group mb-3">
							<label for="province">Chọn tỉnh/thành:</label> <select
								class="form-control form-label" name="province" id="province"
								required>
								<option disabled selected>Chọn tỉnh/thành</option>
							</select>
						</div>

						<div class="form-group mb-3">
							<label for="district">Chọn quận/huyện:</label> <select
								class="form-control form-label" name="district" id="district"
								required>
								<option disabled selected>Chọn quận/huyện</option>
							</select>
						</div>

						<div class="form-group mb-3">
							<label for="ward">Chọn xã/phường:</label> <select
								class="form-control form-label" name="ward" id="ward" required>
								<option disabled selected>Chọn xã/phường</option>
							</select>
						</div>

						<div class="form-group mb-3 ">
							<label for="address">Đường/Hẻm/Số nhà:</label> <input type="text"
								class="form-control form-label" id="address" name="address"
								required>
						</div>

						<!-- <button id="submitBtn" type="submit" class="btn btn-primary">Xác
							nhận địa chỉ</button>

						<div id="selectedAddress" class="mt-4"></div> -->


						<div class="mb-3">
							<label for="note" class="form-label">Ghi chú</label>
							<textarea class="form-control" id="note" name="note" rows="3"
								placeholder="Nhập ghi chú"></textarea>
						</div>
					</form>
				</div>

				<!-- Cột 2: Phương thức thanh toán -->
				<div class="col-12 col-md-4">
					<h3 class="mb-3">Phương thức thanh toán</h3>
					<div class="mb-3">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="payment"
								id="cod" checked> <label class="form-check-label"
								for="cod"> Thanh toán khi giao hàng (COD) </label>
						</div>
						<!-- Các phương thức thanh toán khác -->
					</div>
				</div>

				<!-- Cột 3: Thông tin đơn hàng và giảm giá -->
				<div class="col-12 col-md-4">
					<h3 class="mb-3">Đơn hàng</h3>
					<table class="table">
						<thead>

						</thead>
						<tbody>
							<tr th:each="item: ${cartItems}">
								<td style="position: relative;">
									<div class="product-image-box">
										<img th:src="@{'/img/' + ${item.product.imageURL}}"
											alt="Product Image" class="product-image">

									</div> <span class="product-quantity" th:text="${item.quantity}"></span>
								</td>
								<td th:text="${item.product.productTitle}"></td>
								<td
									th:text="${#numbers.formatInteger(item.product.price * (100 - item.product.sale) / 100, 3, 'POINT')} + ' VNĐ'"></td>
							</tr>


							<!-- <tr>
								<td style="position: relative; margin-top: 10px;">
									<div class="product-image-box">
										<img
											src="https://pos.nvncdn.com/ecf0d0-45233/ps/20190402_Z1hsc6kx0Zi8slTbcQTvmfI0.jpg"
											alt="Product Image" style="max-width: 50px;">
									</div> <span class="product-quantity" aria-hidden="true">1</span>
								</td>
								<td>Serum dưỡng da chống lão hóa</td>
								<td>870,000 ₫</td>
							</tr> -->
						</tbody>
					</table>

					<h3 class="mb-3">Giảm giá</h3>
					<div class="input-group mb-3">
						<input type="text" class="form-control"
							placeholder="Nhập mã giảm giá" aria-label="Mã giảm giá"
							aria-describedby="button-addon2">
						<button class="btn btn-outline-secondary" type="button"
							id="button-addon2">Áp dụng</button>

					</div>
					<a class="previous-link" href="/cart"> <i
						class="fa fa-angle-left fa-lg" aria-hidden="true"></i> <span
						style="color: #3982e0;">< Quay về giỏ hàng</span>
					</a>

					<div class="d-flex flex-column align-items-end">

						<p class="mb-0">Phí vận chuyển: 0 ₫</p>
						<p class="mb-0">
							Tổng cộng: <span
								th:text="${#numbers.formatInteger(totalAmount, 3, 'POINT')} + ' VNĐ'"></span>
						</p>
						<button type="submit" class="btn btn-primary mt-2">Đặt
							hàng</button>

					</div>

				</div>
			</div>
		</div>
	</main>
	<div th:insert="fragments/footer :: footer"></div>
	<!-- Bootstrap JavaScript Libraries -->
	<script
		src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
		integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
		crossorigin="anonymous"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
		integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
		crossorigin="anonymous"></script>


</body>
<script>
document.addEventListener("DOMContentLoaded", function() {
    const token = '03a196a7-9195-11ee-8bfa-8a2dda8ec551'; // Thay thế bằng token thực tế
    const provinceSelect = document.getElementById("province");
    const districtSelect = document.getElementById("district");
    const wardSelect = document.getElementById("ward");

    function updateDistrictOptions(districts) {
        districtSelect.innerHTML = '<option disabled selected>Chọn quận/huyện</option>';
        wardSelect.innerHTML = '<option disabled selected>Chọn xã/phường</option>';

        districts.forEach(district => {
            const option = document.createElement('option');
            option.value = district.DistrictID;
            option.textContent = district.DistrictName;
            districtSelect.appendChild(option);
        });
    }

    function updateWardOptions(wards) {
        wardSelect.innerHTML = '<option disabled selected>Chọn xã/phường</option>';

        wards.forEach(ward => {
            const option = document.createElement('option');
            option.value = ward.WardCode;
            option.textContent = ward.WardName;
            wardSelect.appendChild(option);
        });
    }

    provinceSelect.addEventListener("change", function() {
        const selectedProvinceId = this.value;
        fetch(`https://dev-online-gateway.ghn.vn/shiip/public-api/master-data/district?province_id=${selectedProvinceId}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'token': token
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.data && Array.isArray(data.data)) {
                updateDistrictOptions(data.data);
            } else {
                console.error("Lỗi khi lấy danh sách quận/huyện:", data);
            }
        })
        .catch(error => console.error('Error:', error));
    });

    districtSelect.addEventListener("change", function() {
        const selectedDistrictId = parseInt(this.value, 10);
        fetch('https://dev-online-gateway.ghn.vn/shiip/public-api/master-data/ward', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'token': token
            },
            body: JSON.stringify({ "district_id": selectedDistrictId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.data && Array.isArray(data.data)) {
                updateWardOptions(data.data);
            } else {
                console.error("Lỗi khi lấy danh sách xã/phường:", data);
            }
        })
        .catch(error => console.error('Error:', error));
    });

    // Lấy danh sách tỉnh/thành phố ban đầu
    fetch("https://dev-online-gateway.ghn.vn/shiip/public-api/master-data/province", {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'Token': token
        },
    })
    .then(response => response.json())
    .then(data => {
        if (Array.isArray(data.data)) {
            data.data.forEach(province => {
                const option = document.createElement('option');
                option.value = province.ProvinceID;
                option.textContent = province.ProvinceName;
                provinceSelect.appendChild(option);
            });
        } else {
            console.error("Lỗi khi lấy danh sách tỉnh/thành phố:", data);
        }
    })
    .catch(error => console.error("Lỗi khi lấy danh sách tỉnh/thành phố: ", error));
});
</script>

</html>